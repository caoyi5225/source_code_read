---
title: å¯¹è±¡åˆ›å»º&ç±»çš„å®ç°
date: 2019-03-12 16:26:22
tags:
---

ES5çš„æ ‡å‡†é‡Œæ²¡æœ‰ç±»çš„æ¦‚å¿µ, æ‰€ä»¥å¤§ç‰›ä»¬åˆ›é€ äº†å¾ˆå¤šåˆ›å»ºå¯¹è±¡å’Œæ¨¡æ‹Ÿç±»çš„æ–¹æ³•

## å·¥å‚æ¨¡å¼
å·¥å‚æ¨¡å¼æ˜¯ä¸€ç§å¸¸ç”¨çš„è®¾è®¡æ¨¡å¼,å°†å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹æŠ½è±¡åˆ°ä¸€ä¸ªå‡½æ•°ä¸­
```javascript
function createStudent(name, age, id) {
  var o = new Object(); 
  o.name = name;
  o.age = age;
  o.id = id;
  o.getId = function() {
    return o.id;
  }
  return o;
}

var obj = createStudent('Shadow', 18, 13201);
```
## æ„é€ å‡½æ•°æ¨¡å¼
æ„é€ å‡½æ•°æ˜¯ç”¨æ¥åˆ›å»ºæŸç§ç‰¹å®šç±»å‹å¯¹è±¡çš„å‡½æ•°,æ¯”å¦‚åŸç”Ÿçš„Object, Arrayç­‰,
å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±åˆ›å»ºæ„é€ å‡½æ•°:
```javascript
function Student(name, age, id) {
  this.name = name;
  this.age = age;
  this.id = id;
  this.getId() = function() {
    return this.id;
  }
}

var obj = new Student('Shadow', 18, 13201);
```
æ³¨æ„æ­¤æ„é€ å‡½æ•°ä¸å·¥å‚å‡½æ•°çš„åŒºåˆ«:
1. å‘½ååŒºåˆ«: createStudent --> Student, æ­¤å¤„æ„é€ å‡½æ•°å‘½åä¸ç±»çš„å‘½åä¸€è‡´;
2. æœªåœ¨å‡½æ•°å†…éƒ¨åˆ›å»ºæ–°å¯¹è±¡, è€Œæ˜¯ç›´æ¥æŠŠå±æ€§å’Œæ–¹æ³•èµ‹å€¼ç»™äº†this;
3. æœªå†™returnè¯­å¥;
4. åˆ›å»ºå¯¹è±¡æ—¶ä½¿ç”¨äº†newæ“ä½œç¬¦.
è¿™äº›åŒºåˆ«çš„åŸå› å°±åœ¨newæ“ä½œç¬¦çš„ä½œç”¨ä¸Š(å¼•è‡ªã€ŠJavaScripté«˜çº§ç¨‹åºè®¾è®¡(ç¬¬3ç‰ˆ)ã€‹):
> ï¼ˆ1ï¼‰åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼›
> ï¼ˆ2ï¼‰å°†æ„é€ å‡½æ•°çš„ä½œç”¨åŸŸèµ‹ç»™æ–°å¯¹è±¡ï¼ˆå› æ­¤thiså°±æŒ‡å‘äº†è¿™ä¸ªæ–°å¯¹è±¡ï¼‰ï¼›
> ï¼ˆ3ï¼‰æ‰§è¡Œæ„é€ å‡½æ•°ä¸­çš„ä»£ç ï¼ˆä¸ºè¿™ä¸ªæ–°å¯¹è±¡æ·»åŠ å±æ€§ï¼‰ï¼›
> ï¼ˆ4ï¼‰è¿”å›æ–°å¯¹è±¡ã€‚

ğŸ’¡tips: å…³äºreturnè¯­å¥, å¦‚æœæ„é€ å‡½æ•°å†…å†™äº†returnè¯­å¥, é‚£ä¹ˆä¼šè¦†ç›–newæœ€åä¸€æ­¥è¿”å›returnè¯­å¥å€¼(å¿…é¡»æ˜¯å¯¹è±¡,âš ï¸ nullä¸æ˜¯å¯¹è±¡!!):
```javascript
function Student(name, age, id) {
  this.name = name;
  this.age = age;
  this.id = id;
  this.getId = function() {
    return this.id;
  }
  return { test: 1 };
}

var obj = new Student('Shadow', 18, 13201);
// obj: {test: 1}
```
æ„é€ å‡½æ•°å­˜åœ¨çš„é—®é¢˜:
```javascript
function Student(name, age, id) {
  this.name = name;
  this.age = age;
  this.id = id;
  this.getId = function() {
    return this.id;
  }
}

var shadow = new Student('Shadow', 18, 13201);
var shine = new Student('Sine', 16, 13201);
```
å¦‚ä¸Šæ‰€è§, æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªStudentç±», åŒ…å«ä¸€ä¸ªgetIdçš„æ–¹æ³•, ä¹‹åç”¨è¿™ä¸ªç±»åˆ›å»ºäº†ä¸¤ä¸ªå¯¹è±¡
'shadow'å’Œ'shine', å®ƒä»¬çš„getIdæ–¹æ³•éƒ½æ˜¯ä¸åŒçš„å¼•ç”¨, è€Œå®é™…ä¸Šè¿™æ ·æ˜¯æ²¡æœ‰å¿…è¦çš„, å› ä¸ºgetIdçš„ä½œç”¨ä¸€è‡´,
æ‰€ä»¥ä¸åŒçš„å¯¹è±¡ä½¿ç”¨åŒä¸€ä¸ªæ–¹æ³•å°±å¯ä»¥äº†, è¿™æ ·é€ æˆäº†ç©ºé—´çš„æµªè´¹

## ç»„åˆæ¨¡å¼(æ„é€ å‡½æ•°+åŸå‹æ¨¡å¼)
åœ¨ä¸Šä¸€ç¯‡åŸå‹å’Œç»§æ‰¿çš„æ–‡ç« ä¸­æˆ‘ä»¬ä»‹ç»äº†åŸå‹, åŸå‹å¯ä»¥ç”¨æ¥å­˜æ”¾å…±äº«çš„å±æ€§å’Œæ–¹æ³•, æ„é€ å‡½æ•°ç”¨æ¥æ–°å»ºå®ä¾‹è‡ªå®šä¹‰çš„å±æ€§
```javascript
function Student(name, age, id) {
  this.name = name;
  this.age = age;
  this.id = id;
}
Student.prototype.getId = function() {
  return this.id;
}

var shadow = new Student('Shadow', 18, 13201);
```
æˆ‘ä»¬ä¸€èˆ¬é‡‡å–è¿™ç§æ–¹å¼ä½œä¸ºES5å®ç°ç±»çš„é»˜è®¤æ–¹å¼

## å¯„ç”Ÿæ„é€ å‡½æ•°æ¨¡å¼
è¿™ç§æ¨¡å¼çš„ä½œç”¨ä»…ä»…æ˜¯å°è£…åˆ›å»ºå¯¹è±¡çš„ä»£ç , è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡, ä½†æ˜¯ä½¿ç”¨æ–¹æ³•è·Ÿæ„é€ å‡½æ•°ä¸€æ ·.
```javascript
function MyArray(arr) {
  var o = new Array(arr);

  o.toMyString = function() {
    return this.join(',');
  }

  // é‡å†™æ„é€ å‡½æ•°çš„è¿”å›
  return o;
}

var arr = new MyArray([1, 2, 3]);
```
æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ–¹æ³•é€šè¿‡returné‡å†™äº†newæ—¶çš„è¿”å›æ¥è¾¾åˆ°æ•ˆæœ,
å‡è®¾æˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªå…·æœ‰é¢å¤–æ–¹æ³•çš„ç‰¹æ®Šæ•°ç»„ã€‚ç”±äºä¸èƒ½ç›´æ¥ä¿®æ”¹Arrayæ„é€ å‡½æ•°ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ¨¡å¼

## ç¨³å¦¥æ„é€ å‡½æ•°æ¨¡å¼
æ„å»ºé™¤äº†ä½¿ç”¨æš´éœ²å‡ºæ¥çš„æ–¹æ³•,å¦åˆ™å¤–éƒ¨æ— æ³•è®¿é—®çš„å¯¹è±¡
```javascript
function Student(name) {
  var o = new Object();
  o.getName = function() {
    return name;
  }
  return o;
}

var shadow = new Student('Shadow');
```
ä¸Šè¿°æ¨¡å¼åˆ›å»ºçš„å¯¹è±¡, é™¤äº†ä½¿ç”¨getNameæ–¹æ³•ä¹‹å¤–, æ²¡æœ‰å…¶ä»–é€”å¾„å¾—åˆ°shadowçš„name,
å®ç°åŸç†æ˜¯é€šè¿‡é—­åŒ…
